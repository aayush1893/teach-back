<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#2563eb"/>
    <link rel="manifest" href="/manifest.json" />
    <title>Teach-Back Engine</title>
    <!-- Tailwind is loaded via a JIT CDN script. Subresource Integrity (SRI)
         is not applicable here as the script's content is not static.
         In a production build, Tailwind CSS would be compiled into a static file. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Configure Tailwind to use class-based dark mode.
      // This script must run after the main Tailwind script is loaded.
      tailwind.config = {
        darkMode: 'class',
      }
    </script>
    <!-- React Joyride styles (version pinned for stability) -->
    <link rel="stylesheet" href="https://unpkg.com/react-joyride@2.8.2/dist/react-joyride.css" integrity="sha384-yBzStC/9O/2fV/e8/Js5i/fPLtKqxLfrfPnhp1k3dY/JSti1lR++yGjjf3I/Kjxw" crossorigin="anonymous">
    <script>
      // Prevents Flash of Incorrect Theme by applying the saved theme before the page loads.
      (function() {
        const theme = localStorage.getItem('teachback-theme');
        // If 'dark' is saved, or if no theme is saved but user prefers dark, apply the dark class.
        if (theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
        }
      })();
    </script>
    <style>
      /* --- React Joyride Button Visibility Fix --- */
      /* This style block ensures the tutorial navigation buttons are always visible,
         overcoming potential conflicts with other CSS frameworks like Tailwind. */
      .react-joyride__tooltip button {
        visibility: visible !important;
        opacity: 1 !important;
        cursor: pointer !important;
      }
      .react-joyride__button--primary { /* Next / Done */
        background-color: #2563eb !important;
        color: #ffffff !important;
        border-radius: 6px !important;
        font-size: 14px !important;
        font-weight: 500 !important;
        padding: 8px 16px !important;
        border: none !important;
      }
      .react-joyride__button--secondary { /* Back */
        color: #475569 !important;
        font-size: 14px !important;
        font-weight: 500 !important;
        margin-right: auto !important;
        background-color: transparent !important;
        border: none !important;
        padding: 8px 0 !important;
      }
      .react-joyride__button--close { /* The 'X' button */
        color: #64748b !important;
        position: absolute !important;
        top: 10px !important;
        right: 10px !important;
        padding: 5px !important;
        background: transparent !important;
        border: none !important;
        width: 24px !important;
        height: 24px !important;
      }
       .react-joyride__button--skip {
         color: #475569 !important;
         font-size: 14px !important;
         font-weight: 500 !important;
         text-decoration: none !important;
         background: transparent !important;
         border: none !important;
       }
      /* --- End of Fix --- */
    </style>
    <style>
      @media print {
        body * {
          visibility: hidden;
        }
        #print-summary, #print-summary * {
          visibility: visible;
        }
        #print-summary {
          position: absolute;
          left: 0;
          top: 0;
          width: 100%;
        }
      }
      /* Accessibility: Respect user's preference for reduced motion */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
        }
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.27.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0"
  }
}
</script>
  <!-- PDF.js library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js" integrity="sha512-pce4mSS7E2eOvy7qLglSle42E9FZC6bI4vBqejT2gG03x+3cE4d5OynIqfUfHlXoivP9rI3Vp6rXoK6bA5Gfaw==" crossorigin="anonymous"></script>
  <script>
    // Point to the worker script provided by the CDN
    pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js`;
  </script>
  <!-- React Joyride script (version pinned for stability) -->
  <script src="https://unpkg.com/react-joyride@2.8.2/dist/react-joyride.min.js" integrity="sha384-sI/EGoqIM3GBEDi/K4CqtUPhs27xJ0ZpCVvOFj3F965N75J3zPk0TDAuHIMyf03R" crossorigin="anonymous"></script>
</head>
  <body class="bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-200 transition-colors duration-300">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>